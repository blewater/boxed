@startuml
hide footbox

actor OrgAdmin
boundary "Remote"
boundary TLAdmin
entity TLWorkflow
collections "OrgWorkflows[]"
database "tradeline-fabric-config"

OrgAdmin  --> TLAdmin : gRPC::SendWorkflowNameKey()
TLAdmin -> TLWorkflow : InitWorkflow(workflowNameKey)
TLWorkflow <- "OrgWorkflows[]" : NewWorkflow( workflowNameKey )
    Activate TLWorkflow
    TLWorkflow <- "tradeline-fabric-config": NewWorkflow( config )
    TLWorkflow ->  TLWorkflow : RunMandatoryTasks()
    TLWorkflow  --> Remote : Config <- gRPC::SendFabricConfig()

        Activate Remote
        Remote -> Remote : consume config
        Remote --> TLWorkflow : gRPC:: SendTaskCompletionToServer()
        TLWorkflow -> TLWorkflow : Run() -> Server Tasks
        TLAdmin --> "Remote" : gRPC::SendCliTasks()
        Remote -> Remote : runClientWorkflow()
        Remote --> TLWorkflow : gRPC::SendCliTasksProgress()
        TLWorkflow -> TLWorkflow : CopyCliTasksProgress()
        TLWorkflow -> TLWorkflow : Run() -> Resume Tasks
        TLWorkflow --> Remote : gRPC::SendWorkflowCompletion()
        Remote --> TLAdmin !! : gRPC::SendClose()
        return

    TLAdmin -> TLWorkflow : OrgWorkflow.Save()
    TLWorkflow -> "tradeline-fabric-config" : Save()

    return
@enduml
